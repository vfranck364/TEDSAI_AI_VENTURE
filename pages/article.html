<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse - L'Observatoire TEDSAI</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/mobile-nav.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --obs-primary: #0A2463;
            --obs-secondary: #5AA9E6;
            --obs-bg: #ffffff;
        }

        .article-hero {
            padding: 6rem 0 4rem;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }

        .article-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .article-meta {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            color: #64748b;
            font-size: 0.95rem;
        }

        .article-title {
            font-size: 3.5rem;
            color: var(--obs-primary);
            line-height: 1.2;
            margin-bottom: 2rem;
            font-weight: 800;
        }

        .article-image {
            width: 100%;
            height: 450px;
            object-fit: cover;
            border-radius: 24px;
            margin-bottom: 3rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .article-content {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #334155;
            margin-bottom: 4rem;
        }

        .article-content.columns-2 {
            column-count: 2;
            column-gap: 3rem;
            column-rule: 1px solid #e2e8f0;
        }

        @media (max-width: 768px) {
            .article-content.columns-2 {
                column-count: 1;
            }
        }

        .article-content p {
            margin-bottom: 1.5rem;
        }

        .article-content h1,
        .article-content h2,
        .article-content h3 {
            color: var(--obs-primary);
            margin: 2rem 0 1rem;
        }

        .article-content h1 {
            font-size: 2.2rem;
        }

        .article-content h2 {
            font-size: 1.8rem;
        }

        .article-content ul,
        .article-content ol {
            margin-bottom: 1.5rem;
            padding-left: 2rem;
        }

        .article-content li {
            margin-bottom: 0.5rem;
        }

        .article-content blockquote {
            border-left: 4px solid var(--obs-primary);
            padding-left: 1.5rem;
            font-style: italic;
            color: #64748b;
            margin: 2rem 0;
        }

        .article-content img {
            max-width: 100%;
            border-radius: 16px;
            margin: 2rem 0;
            height: auto;
            display: block;
        }

        .editor-callout {
            background: #f1f5f9;
            border-left: 5px solid var(--obs-primary);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 10px 10px 0;
            font-size: 1.1rem;
        }

        .editor-text-box {
            display: block;
            border: 2px solid #cbd5e1;
            padding: 1rem;
            background: white;
            min-height: 50px;
            margin: 1rem 0;
            border-radius: 8px;
        }

        .transparent-bg {
            background-color: transparent !important;
        }

        .transparent-border {
            border-color: transparent !important;
            border-left-color: transparent !important;
        }

        .editor-button {
            display: inline-block;
            background: var(--obs-primary);
            color: white !important;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 700;
            margin: 1rem 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .editor-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(10, 36, 99, 0.2);
        }

        /* Comments Section */
        .comments-section {
            border-top: 1px solid #e2e8f0;
            padding-top: 4rem;
            margin-top: 4rem;
        }

        .comment-card {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 1.5rem;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .comment-author {
            font-weight: 700;
            color: var(--obs-primary);
        }

        .comment-date {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        .comment-form {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid #e2e8f0;
            margin-top: 3rem;
        }

        .comment-form h3 {
            margin-bottom: 1.5rem;
            color: var(--obs-primary);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            margin-bottom: 1rem;
            font-family: inherit;
        }

        .btn-comment {
            background: var(--obs-primary);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-comment:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(10, 36, 99, 0.2);
        }
    </style>
</head>

<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <a href="../index.html"><img src="../assets/images/logos/tedsai_logo.jpg" alt="TEDSAI Logo"
                        style="height: 50px;"></a>
            </div>
            <nav class="nav-links">
                <a href="../index.html">Accueil</a>
                <a href="solutions-ia.html">Solutions IA</a>
                <a href="vitedia.html">viTEDia</a>
                <a href="garden.html">SelecTED Gardens</a>
                <a href="observatoire.html">L'Observatoire</a>
                <a href="contact.html" class="btn-cta">Contact</a>
            </nav>
        </div>
    </header>

    <main id="article-page-content">
        <!-- Loaded by JS -->
    </main>

    <footer style="background: var(--color-primary); padding: 4rem 0; color: white;">
        <div class="container footer-content"
            style="display: flex; justify-content: space-between; flex-wrap: wrap; text-align: left; gap: 3rem;">
            <div class="footer-col" style="flex: 2; min-width: 300px;">
                <h3 style="color: white; margin-bottom: 1.5rem; font-family: var(--font-accent);">L'Observatoire TEDSAI
                </h3>
                <p style="opacity: 0.8; line-height: 1.6;">Le pôle d'intelligence économique et technologique du
                    Complexe TEDSAI. Analyses et veille pour l'émergence africaine.</p>
            </div>
            <div class="footer-col" style="flex: 1; min-width: 200px;">
                <h4
                    style="color: var(--color-secondary); margin-bottom: 1.2rem; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px;">
                    Écosystème</h4>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.8rem;"><a href="solutions-ia.html"
                            style="color: white; text-decoration: none; opacity: 0.7;">TEDSAI IA</a></li>
                    <li style="margin-bottom: 0.8rem;"><a href="vitedia.html"
                            style="color: white; text-decoration: none; opacity: 0.7;">viTEDia</a></li>
                    <li style="margin-bottom: 0.8rem;"><a href="garden.html"
                            style="color: white; text-decoration: none; opacity: 0.7;">SelecTED Garden</a></li>
                </ul>
            </div>
        </div>
        <div class="container"
            style="text-align:center; margin-top: 3rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 2rem; opacity: 0.6; font-size: 0.9rem;">
            <p>&copy; 2024 TEDSAI Complex. Tous droits réservés.</p>
        </div>
    </footer>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav" aria-label="Navigation mobile principale">
        <div class="mobile-nav-items">
            <a href="../index.html" class="mobile-nav-item" aria-label="Accueil">
                <i class="fa-solid fa-home"></i>
                <span>Accueil</span>
            </a>
            <a href="solutions-ia.html" class="mobile-nav-item" aria-label="Solutions IA">
                <i class="fa-solid fa-brain"></i>
                <span>IA</span>
            </a>
            <a href="vitedia.html" class="mobile-nav-item" aria-label="Restaurant viTEDia">
                <i class="fa-solid fa-utensils"></i>
                <span>viTEDia</span>
            </a>
            <a href="garden.html" class="mobile-nav-item" aria-label="SelecTED Gardens">
                <i class="fa-solid fa-leaf"></i>
                <span>Jardin</span>
            </a>
            <a href="observatoire.html" class="mobile-nav-item active" aria-label="Observatoire">
                <i class="fa-solid fa-satellite-dish"></i>
                <span>Obs</span>
            </a>
        </div>
    </nav>

    <script src="../assets/js/core/db.js"></script>
    <script src="../assets/js/core/api.js"></script>
    <script>
        const ArticlePage = {
            async init() {
                const params = new URLSearchParams(window.location.search);
                const id = params.get('id');
                if (!id) {
                    window.location.href = 'observatoire.html';
                    return;
                }

                const post = TedAPI.Blog.getPost(id);
                if (!post) {
                    document.getElementById('article-page-content').innerHTML = '<div class="article-container" style="padding:10rem 0; text-align:center;"><h2>Article non trouvé.</h2><a href="observatoire.html">Retour à l\'Observatoire</a></div>';
                    return;
                }

                this.render(post);
                this.loadComments(id);
            },

            render(post) {
                const container = document.getElementById('article-page-content');
                const categories = TedAPI.Blog.getCategories();
                const catObj = categories.find(c => c.id === post.category);
                const catName = catObj ? catObj.name : post.category;

                container.innerHTML = `
                    <section class="article-hero">
                        <div class="article-container">
                            <div class="article-meta">
                                <span><i class="fa-solid fa-tag"></i> ${catName}</span>
                                <span><i class="fa-solid fa-user"></i> ${post.author}</span>
                                <span><i class="fa-solid fa-calendar"></i> ${new Date(post.date).toLocaleDateString('fr-FR')}</span>
                            </div>
                            <h1 class="article-title">${post.title}</h1>
                        </div>
                    </section>

                    <section style="padding: 4rem 0; background-color: ${post.bgColor || '#ffffff'};">
                        <div class="article-container">
                            <img src="${post.image || '../assets/images/hero_bg.png'}" class="article-image" alt="${post.title}">
                            <div class="article-content ${post.layout || ''}">
                                ${post.content || post.summary + '<br><br>Le contenu complet de cette analyse sera bientôt disponible. Restez connectés pour plus d\'insights profonds.'}
                            </div>

                            <div class="comments-section" id="comments">
                                <h2>Commentaires (<span id="comment-count">0</span>)</h2>
                                <div id="comments-list" style="margin-top: 2rem;">
                                    <!-- Comments here -->
                                </div>

                                <div class="comment-form">
                                    <h3>Laissez un commentaire</h3>
                                    <form id="comment-form">
                                        <input type="text" id="comment-author" class="form-input" placeholder="Votre nom" required>
                                        <textarea id="comment-text" class="form-input" rows="4" placeholder="Votre commentaire..." required></textarea>
                                        <button type="submit" class="btn-comment">Publier le commentaire</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </section>
                `;

                document.getElementById('comment-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitComment(post.id);
                });
            },

            loadComments(postId) {
                const comments = TedAPI.Blog.getComments(postId);
                const list = document.getElementById('comments-list');
                const count = document.getElementById('comment-count');

                count.textContent = comments.length;

                if (comments.length === 0) {
                    list.innerHTML = '<p style="color:#64748b; font-style:italic;">Soyez le premier à commenter cette analyse.</p>';
                    return;
                }

                list.innerHTML = comments.sort((a, b) => new Date(b.date) - new Date(a.date)).map(c => `
                    <div class="comment-card">
                        <div class="comment-header">
                            <span class="comment-author">${c.author}</span>
                            <span class="comment-date">${new Date(c.date).toLocaleDateString('fr-FR', {
                    day: 'numeric', month: 'long', year: 'numeric'
                })}</span>
                        </div>
                        <div class="comment-body">
                            ${c.text}
                        </div>
                    </div>
                `).join('');
            },

            submitComment(postId) {
                const author = document.getElementById('comment-author').value;
                const text = document.getElementById('comment-text').value;

                TedAPI.Blog.addComment(postId, { author, text });

                // Reset form and reload
                document.getElementById('comment-text').value = '';
                this.loadComments(postId);
            }
        };

        ArticlePage.init();
    </script>
</body>

</html>